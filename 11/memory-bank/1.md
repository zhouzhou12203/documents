flowchart LR
    classDef process fill:#cff,stroke:#333,stroke-width:2px;

    subgraph MainDiagram["贵州大方电厂能源网络流程图"]
        direction LR

        subgraph Zone1_PurchasingStorage["购入储存"]
            direction LR
            CoalIn(["燃料煤 (总购入)<br/>2,521,313 tce"])
            DieselIn(["柴油 (总购入)<br/>2,556 tce"])
            CoalTransport["煤场/输送"]:::process
            L_CoalTransport["输送损失<br/>13,601 tce"]
        end

        subgraph Zone2_ProcessingConversion["加工转换"]
            direction LR
            Boiler["锅炉系统"]:::process
            L_Boiler["锅炉损失<br/>366,038 tce"]
            TurbineGen["汽机-发电机系统"]:::process
            L_TurbineGen["汽机损失<br/>201,181 tce"]
        end

        subgraph Zone3_TransmissionDistribution["输送分配"]
            direction LR
            SteamPipe["蒸汽管道"]:::process
            L_SteamPipe["蒸汽管道损失<br/>991,544 tce"]
            TotalGeneratedElec(["总发电量 (电力)<br/>986,910 tce"])

            subgraph sgAuxPower["厂用电辅助系统"]
                direction LR
                AuxPublic["公用系统<br/>(用电 95 tce)"]:::process
                L_AuxPublic["公用系统损失<br/>95 tce"]
                AuxDesulf["脱硫系统<br/>(用电 85 tce)"]:::process
                L_AuxDesulf["脱硫系统损失<br/>85 tce"]
                AuxOther["其他系统<br/>(用电 254 tce)"]:::process
                L_AuxOther["其他系统损失<br/>254 tce"]
            end
        end

        subgraph Zone4_EndUse["最终使用"]
            direction LR
            NetSupply["净外供电量<br/>951,071 tce"]:::process
        end

        %% Flows within Zone1 and to Zone2
        CoalIn -- "燃料煤<br/>2,521,313" --> CoalTransport
        CoalTransport -- "燃料煤 (至锅炉)<br/>2,507,712" --> Boiler
        CoalTransport --> L_CoalTransport
        DieselIn -- "柴油 (至锅炉)<br/>2,556" --> Boiler

        %% Flows within Zone2 and to Zone3
        Boiler -- "产出蒸汽<br/>2,156,167" --> SteamPipe
        Boiler --> L_Boiler
        SteamPipe -- "输出蒸汽 (至汽机)<br/>1,164,623" --> TurbineGen
        SteamPipe --> L_SteamPipe
        TurbineGen -- "发电量(总)<br/>986,910" --> TotalGeneratedElec
        TurbineGen --> L_TurbineGen
        
        %% Power Distribution from Zone3 (TotalGeneratedElec) to Zone2 (Boiler, TurbineGen) and within Zone3 (Aux systems) and to Zone4 (NetSupply)
        TotalGeneratedElec -- "电力 (锅炉辅机)<br/>11,937" --> Boiler
        TotalGeneratedElec -- "电力 (汽机辅机)<br/>23,468" --> TurbineGen
        TotalGeneratedElec -- "电力 (公用系统)<br/>95" --> AuxPublic
        TotalGeneratedElec -- "电力 (脱硫系统)<br/>85" --> AuxDesulf
        TotalGeneratedElec -- "电力 (其他系统)<br/>254" --> AuxOther
        TotalGeneratedElec -- "净外供电<br/>951,071" --> NetSupply

        %% Losses from Aux systems in Zone3
        AuxPublic --> L_AuxPublic
        AuxDesulf --> L_AuxDesulf
        AuxOther --> L_AuxOther
    end