# 超临界CO2布雷顿循环余热回收系统性能分析与优化 - 复现分析

## 1. 系统概述

本文复现了论文中提出的超临界CO2布雷顿循环(SCBC)与有机朗肯循环(ORC)耦合的余热回收系统。该系统主要包含以下组件：

- 主循环(SCBC)：使用CO2作为工质
- 余热回收循环(ORC)：使用R245fa作为工质
- 换热器网络：包括高温回热器(HTR)和低温回热器(LTR)

## 2. 系统建模与参数设置

### 2.1 基本参数设置

系统的基本参数设置如下（来自`cycle_setup_parameters.json`）：

#### 参考条件
- 环境温度：9.56°C
- 环境压力：101.382 kPa

#### SCBC循环参数
- 压缩机入口压力：7400 kPa
- 压缩机入口温度：35°C
- 透平入口温度：550°C
- 主循环压比：3.0
- 透平效率：0.9
- 压缩机效率：0.85
- HTR效率：0.86
- LTR效率：0.86

#### ORC循环参数
- 透平入口温度：120°C
- 透平膨胀比：3.0
- 透平效率：0.8
- 泵效率：0.75

### 2.2 状态点计算

系统各关键状态点的热力学参数（压力P, 温度T, 焓h, 熵s, 㶲e）根据论文表10数据（标记为“论文”）与本代码使用CoolProp库计算的结果（标记为“计算”）对比如下。计算值是基于论文给定的P、T条件，从 [`calculated_state_points_from_table10.csv`](calculated_state_points_from_table10.csv) 文件中提取的重新计算得到的其他物性。

#### SCBC循环状态点 (CO2)
| 状态点 | P论文<br>(kPa) | P计算<br>(kPa) | T论文<br>(°C) | T计算<br>(°C) | h论文<br>(kJ/kg) | h计算<br>(kJ/kg) | s论文<br>(kJ/kgK) | s计算<br>(kJ/kgK) | 㶲论文<br>(kJ/kg) | 㶲计算<br>(kJ/kg) | 㶲差值<br>(kJ/kg) |
|--------|--------------|--------------|-------------|-------------|---------------|---------------|-----------------|-----------------|---------------|---------------|-----------------|
| 1      | 7400.00      | 7400.00      | 35.00       | 35.00       | 402.40        | 402.40        | 1.66            | 1.6634          | 200.84        | 200.34        | -0.50           |
| 2      | 24198.00     | 24198.00     | 121.73      | 121.73      | 453.36        | 453.35        | 1.68            | 1.6828          | 246.29        | 245.79        | -0.50           |
| 3      | 24198.00     | 24198.00     | 281.92      | 281.92      | 696.46        | 696.46        | 2.21            | 2.2062          | 341.30        | 340.95        | -0.35           |
| 4      | 24198.00     | 24198.00     | 417.94      | 417.94      | 867.76        | 867.76        | 2.48            | 2.4824          | 434.43        | 434.16        | -0.27           |
| 5      | 24198.00     | 24198.00     | 599.85      | 599.85      | 1094.91       | 1094.91       | 2.77            | 2.7741          | 579.03        | 578.85        | -0.18           |
| 6      | 7400.00      | 7400.00      | 455.03      | 455.03      | 932.38        | 932.38        | 2.80            | 2.7991          | 409.40        | 409.23        | -0.17           |
| 7      | 7400.00      | 7400.00      | 306.16      | 306.16      | 761.08        | 761.08        | 2.54            | 2.5362          | 312.52        | 312.28        | -0.24           |
| 8      | 7400.00      | 7400.00      | 147.55      | 147.55      | 582.06        | 582.07        | 2.17            | 2.1749          | 235.75        | 235.41        | -0.34           |
| 9      | 7400.00      | 7400.00      | 84.26       | 84.26       | 503.44        | 503.44        | 1.97            | 1.9719          | 214.69        | 214.17        | -0.52           |

#### ORC循环状态点 (R245fa)
| 状态点 | P论文<br>(kPa) | P计算<br>(kPa) | T论文<br>(°C) | T计算<br>(°C) | h论文<br>(kJ/kg) | h计算<br>(kJ/kg) | s论文<br>(kJ/kgK) | s计算<br>(kJ/kgK) | 㶲论文<br>(kJ/kg) | 㶲计算<br>(kJ/kg) | 㶲差值<br>(kJ/kg) |
|--------|--------------|--------------|-------------|-------------|---------------|---------------|-----------------|-----------------|---------------|---------------|-----------------|
| 09     | 1500.00      | 1500.00      | 127.76      | 127.76      | 505.35        | 505.94        | 1.86            | 1.8657          | 61.21         | 61.44         | 0.23            |
| 010    | 445.10       | 445.10       | 94.67       | 94.67       | 485.51        | 485.99        | 1.88            | 1.8791          | 37.52         | 37.71         | 0.19            |
| 011    | 445.10       | 445.10       | 58.66       | 58.66       | 278.39        | 278.85        | 1.26            | 1.2605          | 5.40          | 5.46          | 0.06            |
| 012    | 1500.00      | 1500.00      | 59.37       | 59.37       | 279.52        | 279.99        | 1.26            | 1.2613          | 6.29          | 6.35          | 0.06            |

## 3. 误差分析

通过对比计算值与论文值，主要误差来源如下：

### 3.1 比焓计算误差
- SCBC循环中比焓误差范围：-0.52 ~ -0.17 kJ/kg
- ORC循环中比焓误差范围：0.06 ~ 0.23 kJ/kg

### 3.2 误差来源分析
1. 物性计算模型差异
   - 使用CoolProp库进行物性计算
   - 论文可能使用不同的物性数据库或计算方法
   - **具体体现**: 从 "2.2 状态点计算"部分的对比表格可以看出，即使给定与论文相同的压力（P）和温度（T）作为输入，使用本代码中的 `CoolProp` 库计算得到的焓（h）、熵（s）和㶲（e）与论文中报告的值也存在微小的系统性差异。
     - 对于SCBC循环中的CO2工质，计算得到的㶲值普遍略低于论文值，差值范围大约在 -0.17 kJ/kg 至 -0.52 kJ/kg 之间。
     - 对于ORC循环中的R245fa工质，计算得到的㶲值普遍略高于论文值，差值范围大约在 0.06 kJ/kg 至 0.23 kJ/kg 之间。
     - 这些基于基础状态点物性的差异，会直接或间接地影响到后续基于这些状态点进行的组件性能计算（例如，压缩机耗功、透平做功、换热器的换热量等）以及最终整个循环的性能评估指标（如热效率、㶲效率）。

2. 数值计算精度
   - 计算过程中的数值舍入
   - 迭代求解过程中的收敛精度

3. 模型简化假设
   - 换热器效率的简化处理
   - 压力损失的简化计算

### 3.3 `full_cycle_simulator.py` 输出结果解读与复现对应

当运行主模拟脚本 [`full_cycle_simulator.py`](full_cycle_simulator.py:1) 时，其在控制台的输出具有以下含义，并对应了论文中的分析操作：

*   **状态点参数打印**: 脚本会逐步计算并打印出SCBC循环中关键状态点（如点1至点8，以及一些中间计算点）的压力、温度、焓等参数。这些参数是根据 [`cycle_setup_parameters.json`](cycle_setup_parameters.json) 中定义的初始条件和组件效率，通过调用 [`cycle_components.py`](cycle_components.py:1) 中的模型函数计算得到的。
    *   **对应论文操作**: 这直接对应了论文中对热力学循环进行分析时，确定各个关键状态点热力学参数的过程。例如，计算主压缩机MC出口（点2）的T和h，并与论文表10的点2进行对比，这是复现论文中“压缩过程分析”的操作。类似地，计算透平T出口（点6）并与论文对比，则对应“膨胀过程分析”。

*   **组件性能输出**: 对于主要的做功或耗功组件（如主压缩机MC、再压缩机RC、SCBC透平T），脚本会计算并打印其单位质量耗功/做功量以及总功率。对于换热组件（如LTR、HTR、ER），会计算并打印其换热量。
    *   **对应论文操作**: 这些能量数值是进行系统能量平衡、火用平衡分析以及计算循环效率等宏观性能指标的基础。例如，脚本中对LTR和HTR的计算，使用了论文中给定的效能值，这是复现论文中“回热过程分析”的操作。对ER（吸热器）的计算，目标是达到论文中设定的透平入口温度（点5），这对应论文中的“吸热过程分析”。

*   **与论文数据对比**: 脚本在计算出一些关键状态点或性能参数后，会直接在控制台将其与论文表10中的数据进行对比。
    *   **对应论文操作**: 这是对复现结果准确性的直接检验，帮助判断当前模型和参数设置与论文描述的吻合程度。

*   **当前模拟的局限性与说明**:
    *   **迭代收敛问题**: [`full_cycle_simulator.py`](full_cycle_simulator.py:1) 目前对低温回热器（LTR）的热流进口状态（点7，即HTR热出口）和高温回热器（HTR）的热流进口状态（点6，即透平出口）是基于论文表10数据的**初始假设**进行计算的。在一个完整的、自洽的循环模拟中，透平的实际出口状态应该作为HTR的热进口，而HTR的实际热出口状态应该作为LTR的热进口。这通常需要通过迭代计算，不断更新这些假设值，直到整个循环达到能量和质量的平衡，各点参数收敛稳定。
    *   **当前脚本状态**: 目前的脚本实现了这些组件的初步序贯计算，并明确指出了需要迭代逻辑。因此，模拟器当前阶段输出的依赖于这些假设点的后续计算结果（例如RC的进口状态、混合点3的状态等）是初步的，可能与论文最终经过优化和迭代收敛后的结果存在偏差。论文中的表10数据本身应视为优化和迭代收敛后的理想结果。
    *   **主要目的**: 因此，当前 [`full_cycle_simulator.py`](full_cycle_simulator.py:1) 的输出主要是为了验证单个组件模型的计算逻辑的正确性，以及在给定理想化（部分基于论文结果）边界条件下的初步吻合度，而非提供一个完全收敛和自洽的整个联合循环的最终性能数据。ORC侧及SCBC低温侧（如主冷却器CS、与ORC耦合的蒸发器GO）的完整计算也尚未在主模拟流程中完全整合和迭代。

## 4. 系统性能分析

### 4.1 主要性能指标
- 系统总功率输出
- 热效率
- 换热器性能
- 组件效率

### 4.2 优化方向
1. 参数优化
   - 压比优化
   - 温度优化
   - 流量分配优化

2. 系统集成优化
   - 换热器网络优化
   - 组件匹配优化

## 5. 结论与建议

1. 复现结果与论文数据基本吻合，主要性能指标误差在可接受范围内
2. 建议进一步优化：
   - 提高物性计算精度
   - 完善换热器模型
   - 考虑实际运行中的压力损失

## 6. 后续工作

1. 完善系统模型
2. 进行参数敏感性分析
3. 开展系统优化研究
4. 进行经济性分析

## 7. 代码实现与复现进度

### 7.1 已实现功能

#### 7.1.1 核心模块
1. `state_point_calculator.py`
   - **功能概述**: 该脚本主要负责工质热力学状态点的物性计算、验证论文数据，并生成循环模拟所需的参数配置文件。
   - **环境参考态**: 定义了用于㶲计算的全局环境参考温度 `T0_CELSIUS` (9.56 °C) 和压力 `P0_KPA` (101.382 kPa)。
   - **辅助函数**: 提供了单位转换函数 [`to_kelvin()`](state_point_calculator.py:14) 和 [`to_pascal()`](state_point_calculator.py:18)。
   - **`StatePoint` 类**:
     - **核心作用**: 封装一个热力学状态点的所有相关属性（P, T, h, s, d, e, q, m_dot）和计算方法。
     - **物性计算**: 依赖 `CoolProp.CoolProp.PropsSI` 函数，可以根据两组已知的独立参数（如P-T, P-H, P-S, P-Q）计算其他所有热力学性质。
     - **㶲计算**: 内含 `_calculate_exergy` 方法，根据当前状态和预设的环境参考态计算物理㶲。
     - **支持工质**: 初始化时指定工质名称（如 "CO2", "R245fa"）。
   - **主程序逻辑 (`if __name__ == "__main__":`)**:
     - **数据验证与输出**:
       - 从 `validation_data` (硬编码的论文表10数据) 中读取各状态点的P, T, h, s, e及质量流量。
       - 对每个状态点，使用论文给定的P和T，通过 `StatePoint` 类重新计算h, s, d, e。
       - 将计算结果与论文数据进行对比（特别是㶲），并将详细结果打印到控制台并输出到 [`calculated_state_points_from_table10.csv`](calculated_state_points_from_table10.csv) 文件。
     - **参数文件生成**:
       - 定义一个包含SCBC和ORC循环设计参数（如关键点温度压力、组件效率、压比等）的字典 `cycle_parameters`。
       - 将此字典保存为 [`cycle_setup_parameters.json`](cycle_setup_parameters.json) 文件，供 [`full_cycle_simulator.py`](full_cycle_simulator.py:1) 加载使用。
     - **T0/P0反推 (可选)**: 包含了基于论文数据反推最优环境参考态T0和P0的函数 (`run_t0_p0_fitting`)，但默认未执行。

2. `cycle_components.py`
   - **功能概述**: 此脚本定义了构成SCBC/ORC联合循环的各个热力学组件的数学模型。每个模型函数接收进口状态点对象(以及其他特定参数如压力、效率、目标温度等)，计算并返回出口状态点对象及相关的能量变化值（功或热量）。
   - **依赖**: 依赖于 [`state_point_calculator.py`](state_point_calculator.py:1) 中定义的 `StatePoint` 类。
   - **主要组件模型**:
     - **[`model_compressor_MC(state_in, P_out_Pa, eta_isen)`](cycle_components.py:7)**: 模拟压缩机（主压缩机MC或再压缩机RC）。根据进口状态、目标出口压力和等熵效率，计算实际出口状态和单位质量耗功。
     - **[`model_turbine_T(state_in, P_out_Pa, eta_isen)`](cycle_components.py:59)**: 模拟透平（SCBC透平T或ORC透平TO）。根据进口状态、目标出口压力和等熵效率，计算实际出口状态和单位质量做功。
     - **[`model_pump_ORC(state_in, P_out_Pa, eta_isen)`](cycle_components.py:110)**: 模拟ORC泵(PO)。与压缩机模型类似，计算实际出口状态和单位质量耗功。
     - **[`model_heat_exchanger_effectiveness(state_hot_in, state_cold_in, effectiveness, hot_fluid_is_C_min_side, ...)`](cycle_components.py:158)**: 模拟基于效能定义的换热器（如回热器LTR、HTR）。根据两侧进口状态、效能和效能定义基准侧，计算两侧出口状态和总换热量。
     - **[`model_evaporator_GO(state_hot_in, state_cold_in, T_hot_out_K/h_hot_out_J_kg/T_cold_out_K/h_cold_out_J_kg, ...)`](cycle_components.py:642)**: 模拟蒸发器/气体冷却器（如SCBC与ORC之间的耦合换热器GO）。需要指定一侧的出口条件（温度或焓）来确定换热过程，然后计算另一侧的出口状态和总换热量。
     - **[`model_cooler_set_T_out(state_in, T_out_K, ...)`](cycle_components.py:705)**: 模拟将工质冷却到指定出口温度的冷却器（如SCBC主冷却器CS、ORC次冷却器CO）。计算出口状态和排出的总热量。
     - **[`model_heater_set_T_out(state_in, T_out_K, ...)`](cycle_components.py:750)**: 模拟将工质加热到指定出口温度的加热器（如SCBC吸热器ER）。计算出口状态和吸收的总热量。
   - **测试代码**: 脚本的 `if __name__ == '__main__':` 部分包含了对每个组件模型的单元测试，使用论文表10的数据作为输入和验证基准，确保模型计算的正确性。

3. `full_cycle_simulator.py`
   - **功能概述**: 作为整个联合循环的模拟器，负责协调各个组件模型的计算，并根据设定的参数模拟整个热力学循环的**过程**。它的目标是复现论文中对整个热力学循环的分析步骤，通过调用各个组件模型，一步步地计算工质流经整个系统时的状态变化和能量转换。
   - **参数加载**: 通过 [`load_cycle_parameters()`](full_cycle_simulator.py:14) 函数从 [`cycle_setup_parameters.json`](cycle_setup_parameters.json) 文件加载循环配置。
   - **SCBC循环模拟 (`simulate_scbc_orc_cycle`)**:
     - **初始化**: 设定SCBC循环的初始状态点1。
     - **组件序贯计算**: 按照SCBC流程（主压缩机、低温回热器、再压缩机、混合点、高温回热器、吸热器、透平）依次调用各组件模型进行计算。
     - **与论文数据对比**: 在计算过程中，会打印关键状态点的计算结果并与论文表10数据进行对比。
     - **当前局限性**: 如 "3.3 `full_cycle_simulator.py` 输出结果解读与复现对应" 小节所述，当前模拟对部分回热器进口采用了基于论文数据的假设，尚未实现完整的迭代收敛逻辑，ORC及SCBC低温侧的完整耦合计算也有待进一步实现。
   - **主程序入口 (`if __name__ == '__main__':`)**: 加载参数并调用仿真函数。

### 7.2 复现进度

#### 7.2.1 已完成工作
1. 系统建模
   - [x] 建立基本组件模型
   - [x] 实现状态点计算
   - [x] 完成换热器网络建模
   - [x] 实现循环耦合计算

2. 参数验证
   - [x] 验证SCBC循环参数
   - [x] 验证ORC循环参数
   - [x] 验证换热器参数

3. 状态点计算
   - [x] 完成SCBC循环12个状态点计算
   - [x] 完成ORC循环4个状态点计算
   - [x] 实现状态点数据导出

#### 7.2.2 进行中工作
1. 系统优化
   - [ ] 实现参数敏感性分析
   - [ ] 开发优化算法
   - [ ] 进行系统性能优化

2. 误差分析
   - [ ] 完善误差来源分析
   - [ ] 优化计算精度
   - [ ] 改进模型假设

#### 7.2.3 待完成工作
1. 系统完善
   - [ ] 添加经济性分析模块
   - [ ] 实现动态仿真功能
   - [ ] 开发可视化界面

2. 验证与测试
   - [ ] 进行更多工况验证
   - [ ] 开展实验对比
   - [ ] 完善文档说明

### 7.3 代码结构
```
study/
├── full_cycle_simulator.py    # 主循环模拟器
├── cycle_components.py        # 组件模型
├── state_point_calculator.py  # 状态点计算
├── cycle_setup_parameters.json # 系统参数配置
└── calculated_state_points_from_table10.csv # 计算结果
```

### 7.4 代码与数据文件协同工作流程及作用

这套代码通过模块化的方式实现了对SCBC/ORC联合循环的模拟与分析。其核心工作流程和各文件作用如下：

1.  **[`state_point_calculator.py`](state_point_calculator.py:1) (状态点计算器)**:
    *   **核心作用**: 提供基础的热力学物性计算能力。
    *   **`StatePoint` 类**: 封装了工质在特定状态下的所有热力学参数（P, T, h, s, d, e 等），并能根据已知的两个参数（如P-T, P-h）使用 `CoolProp` 库计算其他所有参数。这是整个系统中数据传递和计算的基础单元。
    *   **参数文件生成**: 当作为主脚本运行时，它会生成 [`cycle_setup_parameters.json`](cycle_setup_parameters.json) 文件。这个JSON文件预设了整个联合循环的各项设计参数，如各循环的工质、关键点的初始温度/压力、各部件（压缩机、透平、泵）的效率、换热器的效能等。这些参数是后续循环模拟的输入依据。
    *   **数据验证与输出**: 同时，它会读取论文表10中的状态点数据，使用 `StatePoint` 类和 `CoolProp` 重新计算这些点的物性，并将计算结果与论文值进行对比（特别是㶲），最终将详细的对比数据输出到 [`calculated_state_points_from_table10.csv`](calculated_state_points_from_table10.csv) 文件。这为模型的准确性提供了一个初步的验证。

2.  **[`cycle_components.py`](cycle_components.py:1) (循环组件模型)**:
    *   **核心作用**: 定义了联合循环中各个物理组件（如压缩机、透平、泵、换热器、冷却器、加热器）的数学模型。
    *   **模型函数**: 每个组件对应一个或多个模型函数。这些函数接收代表进口工质状态的 `StatePoint` 对象以及组件的特定运行参数（如目标压力、效率、目标出口温度、换热器效能等），然后计算并返回出口工质状态的 `StatePoint` 对象以及该组件的能量变化（如耗功、做功、换热量）。
    *   **依赖关系**: 这些模型函数严重依赖 [`state_point_calculator.py`](state_point_calculator.py:1) 中定义的 `StatePoint` 类来进行物性查询和状态更新。

3.  **[`full_cycle_simulator.py`](full_cycle_simulator.py:1) (全循环模拟器)**:
    *   **核心作用**: 作为顶层协调者，将各个独立的组件模型按照热力学循环的实际流程串联起来，模拟整个SCBC/ORC联合循环的运行。
    *   **参数加载**: 首先调用 [`load_cycle_parameters()`](full_cycle_simulator.py:14) 函数从 [`cycle_setup_parameters.json`](cycle_setup_parameters.json) 文件中读取预设的循环配置参数。
    *   **序贯计算**: 在 [`simulate_scbc_orc_cycle()`](full_cycle_simulator.py:31) 函数中，根据加载的参数和论文中描述的循环结构，依次调用 [`cycle_components.py`](cycle_components.py:1) 中定义的相应组件模型函数。例如，从SCBC主压缩机的进口点开始，计算其出口状态，该出口状态又成为下一个组件（如低温回热器冷侧）的进口状态，如此一步步推进，直到完成一个或多个循环的计算。
    *   **迭代与收敛 (当前局限性)**: 对于包含回热的复杂循环，某些点的状态（如回热器的热流进口）在初次计算时可能需要假设值，并通过多次迭代计算才能达到收敛。当前版本的 [`full_cycle_simulator.py`](full_cycle_simulator.py:1) 实现了初步的序贯计算，并指出了需要迭代逻辑来使特定点（如HTR和LTR的热流进口）收敛，但完整的迭代收敛逻辑和ORC侧及SCBC低温侧的详细计算尚未完全实现。
    *   **结果输出与对比**: 在计算过程中，会将关键状态点的计算结果（如温度、焓）与论文表10的数据进行打印对比，以监控计算过程的合理性。

4.  **数据文件**:
    *   **[`cycle_setup_parameters.json`](cycle_setup_parameters.json)**:
        *   **作用**: 存储了整个联合循环的配置参数和设计规范。它作为 [`full_cycle_simulator.py`](full_cycle_simulator.py:1) 的主要输入，定义了模拟的边界条件和组件性能。
        *   **生成**: 由 [`state_point_calculator.py`](state_point_calculator.py:1) 在其主程序块中生成并写入。
        *   **内容示例**: 工质类型、参考环境条件、SCBC和ORC各关键点的目标参数（如P1压力、T5温度）、各组件效率（透平、压缩机、泵效率）、换热器效能等。
    *   **[`calculated_state_points_from_table10.csv`](calculated_state_points_from_table10.csv)**:
        *   **作用**: 记录了基于论文表10给定的P,T值，使用当前代码中的 `StatePoint` 类和 `CoolProp` 物性库重新计算得到的所有热力学状态点的详细参数，并与论文中的原始数据（特别是㶲值）进行了对比。
        *   **生成**: 由 [`state_point_calculator.py`](state_point_calculator.py:1) 在其主程序块中进行数据验证时生成并写入。
        *   **内容**: 包含了每个状态点的名称、工质、论文给定的P,T,h,s,e,m_dot值，以及代码计算出的P,T,h,s,d,e值，和计算㶲与论文㶲的差值。这个文件是评估当前物性计算模型与论文数据吻合程度的重要依据。

**总结**:
整个代码库形成了一个清晰的计算流程：
`state_point_calculator.py` 提供基础物性计算工具和初始参数/验证数据 -> `cycle_components.py` 基于这些工具构建独立的组件模型 -> `full_cycle_simulator.py` 利用这些组件模型和参数文件来模拟完整的循环。数据文件则在参数传递和结果验证中起到关键作用。

### 7.5 下一步计划
1. 完善系统模型
   - 优化换热器模型
   - 改进压力损失计算
   - 添加更多组件模型

2. 提高计算精度
   - 优化物性计算
   - 改进数值方法
   - 完善误差分析

3. 扩展功能
   - 添加经济性分析
   - 实现参数优化
   - 开发可视化工具 